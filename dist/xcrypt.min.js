;function XCRYPT(){const t={i2a:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],a2i:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],amap:{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},hex:function(t){if(null==t)return"??";var e=(t&=255).toString(16);return e.length<2?"0"+e:e},hex_encode:function(e,n,r){null==r&&(r=""),null==n&&(n=256);for(var i="",a=0;a<e.length;a++)a%n==0&&0<a&&(i+="\n"),i+=t.hex(e[a])+r;return i.toUpperCase()},get_amap:function(e){var n=t.amap[e];if(null==n)throw"found an invalid character.";return n},hex_decode:function(e){for(var n=[],r=0,i=0;r<e.length;r++){var a=e.charAt(r);"s"!=a&&(n[i++]=a)}if(n.length%2!=0)throw"data must be a multiple of two.";var o=new Array(n.length>>1);for(r=0;r<n.length;r+=2){var f=255&(t.get_amap(n[r])<<4|t.get_amap(n[r+1]));o[r>>1]=f}return o},base64_encode:function(e){for(var n=e.length,r=Math.floor(n/3),i=n-3*r,a="",o=0,f=0;f<r;f++){var c=255&e[o++],s=255&e[o++],u=255&e[o++];a+=t.i2a[c>>2],a+=t.i2a[c<<4&63|s>>4],a+=t.i2a[s<<2&63|u>>6],a+=t.i2a[63&u]}if(0==i);else if(1==i){c=255&e[o++];a+=t.i2a[c>>2],a+=t.i2a[c<<4&63],a+="=="}else{if(2!=i)throw"never happen";c=255&e[o++],s=255&e[o++];a+=t.i2a[c>>2],a+=t.i2a[c<<4&63|s>>4],a+=t.i2a[s<<2&63],a+="="}return a},base64_decode:function(e){var n=e.length,r=Math.floor(n/4);if(4*r!=n)throw"String length must be a multiple of four.";var i=0;0!=n&&("="==e.charAt(n-1)&&(i++,r--),"="==e.charAt(n-2)&&i++);var a=3*r-i;a<0&&(a=0);for(var o=new Array(a),f=0,c=0,s=0;s<r;s++){var u=t.get_a2i(e.charCodeAt(f++)),h=t.get_a2i(e.charCodeAt(f++)),l=t.get_a2i(e.charCodeAt(f++)),d=t.get_a2i(e.charCodeAt(f++));o[c++]=255&(u<<2|h>>4),o[c++]=255&(h<<4|l>>2),o[c++]=255&(l<<6|d)}if(0==i);else if(1==i){u=t.get_a2i(e.charCodeAt(f++)),h=t.get_a2i(e.charCodeAt(f++)),l=t.get_a2i(e.charCodeAt(f++));o[c++]=255&(u<<2|h>>4),o[c++]=255&(h<<4|l>>2)}else{if(2!=i)throw"never happen";u=t.get_a2i(e.charCodeAt(f++)),h=t.get_a2i(e.charCodeAt(f++));o[c++]=255&(u<<2|h>>4)}return o},get_a2i:function(e){var n=0<=e&&e<t.a2i.length?t.a2i[e]:-1;if(n<0)throw"Illegal character "+e;return n},str2utf8:function(t){for(var e=[],n=t.length,r=0,i=0;i<n;i++){var a=t.charCodeAt(i);if(a<=127)e[r++]=a;else if(a<=2047)e[r++]=192|31&a>>>6,e[r++]=128|63&a>>>0;else if(a<=65535)e[r++]=224|15&a>>>12,e[r++]=128|63&a>>>6,e[r++]=128|63&a>>>0;else{if(!(a<=1114111))throw"error";e[r++]=240|7&a>>>18,e[r++]=128|63&a>>>12,e[r++]=128|63&a>>>6,e[r++]=128|63&a>>>0}}return e},utf82str:function(t){for(var e="",n=t.length,r=0;r<n;){var i=t[r++];i<128?e+=String.fromCharCode(i):i<224?e+=String.fromCharCode((31&i)<<6|(63&t[r++])<<0):i<240?e+=String.fromCharCode((15&i)<<12|(63&t[r++])<<6|(63&t[r++])<<0):i<248?e+=String.fromCharCode((7&i)<<18|(63&t[r++])<<12|(63&t[r++])<<6|(63&t[r++])<<0):i<252?e+=String.fromCharCode((3&i)<<24|(63&t[r++])<<18|(63&t[r++])<<12|(63&t[r++])<<6|(63&t[r++])<<0):i<254&&(e+=String.fromCharCode((1&i)<<30|(63&t[r++])<<24|(63&t[r++])<<18|(63&t[r++])<<12|(63&t[r++])<<6|(63&t[r++])<<0))}return e}};function e(t,e){return 255&(t<<e|t>>>8-e)}function n(t,e){return 4294967295&(t<<e|t>>>32-e)}function r(t,e){return t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24}function i(t,e,n){t.splice(e,4,255&n,n>>>8&255,n>>>16&255,n>>>24&255)}function a(t,e,n){t.splice(e,4,n>>>24&255,n>>>16&255,n>>>8&255,255&n)}function o(t,e){return t>>>8*e&255}function f(){return window.crypto.getRandomValues(new Uint8Array(1))[0]}const c={AES:function(){var t,a,f,c,s,u,h,l,d,g,v,y,p,m=null,w=null,A=-1;function C(t,e){return t&&e?f[(c[t]+c[e])%255]:0}function B(){return[r(w,A),r(w,A+4),r(w,A+8),r(w,A+12)]}function _(t){for(var e=0;e<4;e++,A+=4)i(w,A,t[e])}function O(t){return 256&(t<<=1)?283^t:t}function x(t){return s[o(t,0)]|s[o(t,1)]<<8|s[o(t,2)]<<16|s[o(t,3)]<<24}function b(t,e){return C(o(t,0),o(e,0))^C(o(t,1),o(e,1))^C(o(t,2),o(e,2))^C(o(t,3),o(e,3))}function k(t){var n=f[255-c[t]];return n^=t=e(t=n,1),n^=t=e(t,1),n^=t=e(t,1),(t=e(t,1))^n^99}function S(t,e,r,i,o){var f,c,s,u,h=new Array(4);for(u=0;u<4;u++)t[u]^=e[u];for(f=1;f<a;f++){for(c=s=0;c<4;c++,s+=3)h[c]=e[u++]^r[255&t[c]]^n(r[t[i[s]]>>>8&255],8)^n(r[t[i[s+1]]>>>16&255],16)^n(r[t[i[s+2]]>>>24&255],24);var l=t;t=h,h=l}for(c=s=0;c<4;c++,s+=3)h[c]=e[u++]^o[255&t[c]]^n(o[t[i[s]]>>>8&255],8)^n(o[t[i[s+1]]>>>16&255],16)^n(o[t[i[s+2]]>>>24&255],24);return h}return{blocksize:16,open:function(e){for(var i,o,w,A=0,B=(m=(m=e).slice(0,32)).length;16!=B&&24!=B&&32!=B;)m[B++]=m[A++];!function(){var t,e;for(f=[1,3],c=[0,0,null,1],s=new Array(256),u=new Array(256),l=new Array(256),d=new Array(256),h=new Array(30),t=2;t<256;t++)f[t]=f[t-1]^O(f[t-1]),c[f[t]]=t;for(s[0]=99,u[99]=0,t=1;t<256;t++)e=k(t),s[t]=e,u[e]=t;for(t=0,e=1;t<30;t++)h[t]=e,e=O(e);for(t=0;t<256;t++)e=s[t],l[t]=O(e)|e<<8|e<<16|(e^O(e))<<24,e=u[t],d[t]=C(14,e)|C(9,e)<<8|C(13,e)<<16|C(11,e)<<24}(),t=m.length>>>2;var _,S=4*((a=6+t)+1);for(g=new Array(12),v=new Array(12),y=new Array(S),p=new Array(S),w=A=0;A<4;A++,w+=3)g[w]=(A+1)%4,g[w+1]=(A+2)%4,g[w+2]=(A+3)%4,v[w]=(4+A-1)%4,v[w+1]=(4+A-2)%4,v[w+2]=(4+A-3)%4;for(i=A=0;i<t;i++,A+=4)y[i]=r(m,A);for(o=0,A=t;A<S;A+=t,o++)if(y[A]=y[A-t]^x(n(y[A-1],24))^h[o],t<=6)for(i=1;i<t&&i+A<S;i++)y[i+A]=y[i+A-t]^y[i+A-1];else{for(i=1;i<4&&i+A<S;i++)y[i+A]=y[i+A-t]^y[i+A-1];for(A+4<S&&(y[A+4]=y[A+4-t]^x(y[A+3])),i=5;i<t&&i+A<S;i++)y[i+A]=y[i+A-t]^y[i+A-1]}for(A=0;A<4;A++)p[A+S-4]=y[A];for(i=4;i<S-4;i+=4)for(o=S-4-i,A=0;A<4;A++)p[o+A]=b(151849742,_=y[i+A])|b(218828297,_)<<8|b(185469197,_)<<16|b(235474187,_)<<24;for(A=S-4;A<S;A++)p[A-S+4]=y[A]},close:function(){f=c=s=u=h=null,l=d=g=v=y=p=null},encrypt:function(t,e){w=t,A=e,_(S(B(),y,l,g,s))},decrypt:function(t,e){w=t,A=e,_(S(B(),p,d,v,u))}}},SERPENT:function(){var t=null,e=null,i=-1,o=[];function f(t,e,n,r,i,a){t[e]^=o[4*a],t[n]^=o[4*a+1],t[r]^=o[4*a+2],t[i]^=o[4*a+3]}function c(t,e,r,i,a,f,c){t[e]=n(t[e],13),t[i]=n(t[i],3),t[r]^=t[e],t[f]=t[e]<<3&4294967295,t[a]^=t[i],t[r]^=t[i],t[r]=n(t[r],1),t[a]^=t[f],t[a]=n(t[a],7),t[f]=t[r],t[e]^=t[r],t[f]=t[f]<<7&4294967295,t[i]^=t[a],t[e]^=t[a],t[i]^=t[f],t[a]^=o[4*c+3],t[r]^=o[4*c+1],t[e]=n(t[e],5),t[i]=n(t[i],22),t[e]^=o[4*c+0],t[i]^=o[4*c+2]}function s(t,e,r,i,a,f,c){t[e]^=o[4*c+0],t[r]^=o[4*c+1],t[i]^=o[4*c+2],t[a]^=o[4*c+3],t[e]=n(t[e],27),t[i]=n(t[i],10),t[f]=t[r],t[i]^=t[a],t[e]^=t[a],t[f]=t[f]<<7&4294967295,t[e]^=t[r],t[r]=n(t[r],31),t[i]^=t[f],t[a]=n(t[a],25),t[f]=t[e]<<3&4294967295,t[r]^=t[e],t[a]^=t[f],t[e]=n(t[e],19),t[r]^=t[i],t[a]^=t[i],t[i]=n(t[i],29)}var u=[function(t,e,n,r,i,a){t[a]=t[i],t[i]|=t[e],t[e]^=t[a],t[a]^=t[r],t[a]=~t[a],t[i]^=t[n],t[n]&=t[e],t[n]^=t[a],t[r]^=t[e],t[e]^=t[i],t[a]|=t[e],t[e]^=t[r],t[r]&=t[n],t[i]^=t[r],t[n]=~t[n],t[r]^=t[a],t[n]^=t[r]},function(t,e,n,r,i,a){t[a]=t[n],t[n]^=t[e],t[e]^=t[i],t[i]=~t[i],t[a]&=t[n],t[e]|=t[n],t[i]^=t[r],t[e]^=t[i],t[n]^=t[i],t[i]^=t[a],t[n]|=t[a],t[a]^=t[r],t[r]&=t[e],t[r]^=t[n],t[n]|=t[e],t[e]=~t[e],t[e]^=t[r],t[a]^=t[n]},function(t,e,n,r,i,a){t[i]=~t[i],t[n]^=t[e],t[a]=t[e],t[e]&=t[r],t[e]^=t[i],t[i]|=t[a],t[r]^=t[n],t[i]^=t[n],t[n]&=t[e],t[e]^=t[r],t[r]&=t[i],t[i]|=t[n],t[e]=~t[e],t[i]^=t[e],t[a]^=t[e],t[e]^=t[r],t[n]|=t[r]},function(t,e,n,r,i,a){t[a]=t[n],t[n]^=t[i],t[i]|=t[e],t[a]&=t[e],t[e]^=t[r],t[r]^=t[n],t[n]&=t[i],t[r]^=t[i],t[e]|=t[a],t[a]^=t[i],t[n]^=t[e],t[e]&=t[i],t[i]&=t[a],t[i]^=t[r],t[a]|=t[n],t[r]&=t[n],t[a]^=t[i],t[e]^=t[i],t[i]^=t[r]},function(t,e,n,r,i,a){t[a]=t[i],t[i]&=t[e],t[e]^=t[a],t[i]^=t[r],t[r]|=t[a],t[e]^=t[n],t[a]^=t[i],t[r]|=t[e],t[r]^=t[n],t[n]&=t[e],t[n]^=t[a],t[a]&=t[r],t[r]^=t[i],t[a]^=t[e],t[i]|=t[n],t[n]=~t[n],t[i]^=t[e]},function(t,e,n,r,i,a){t[a]=t[n],t[n]|=t[e],t[r]^=t[n],t[i]=~t[i],t[a]^=t[e],t[e]^=t[r],t[n]&=t[a],t[a]|=t[i],t[a]^=t[e],t[e]&=t[i],t[n]^=t[i],t[i]^=t[r],t[e]^=t[n],t[r]&=t[a],t[n]^=t[r],t[r]&=t[e],t[i]^=t[r]},function(t,e,n,r,i,a){t[a]=t[n],t[i]^=t[e],t[n]^=t[r],t[r]^=t[e],t[e]&=t[i],t[n]|=t[i],t[a]=~t[a],t[e]^=t[n],t[n]^=t[r],t[i]^=t[a],t[a]^=t[e],t[r]&=t[e],t[a]^=t[n],t[r]^=t[i],t[i]&=t[n],t[i]^=t[e],t[n]^=t[r]},function(t,e,n,r,i,a){t[n]=~t[n],t[a]=t[n],t[e]=~t[e],t[n]&=t[r],t[n]^=t[i],t[i]|=t[a],t[a]^=t[r],t[r]^=t[i],t[i]^=t[e],t[e]|=t[n],t[r]&=t[e],t[e]^=t[a],t[a]^=t[i],t[i]&=t[e],t[a]^=t[n],t[r]^=t[a],t[i]^=t[n],t[a]|=t[e],t[a]^=t[n]}],h=[function(t,e,n,r,i,a){t[a]=t[i],t[n]^=t[e],t[i]|=t[n],t[a]^=t[n],t[e]=~t[e],t[r]^=t[i],t[i]^=t[e],t[e]&=t[n],t[e]^=t[r],t[r]&=t[i],t[i]^=t[a],t[r]^=t[i],t[n]^=t[i],t[i]&=t[e],t[n]^=t[e],t[e]^=t[r],t[a]^=t[i]},function(t,e,n,r,i,a){t[n]^=t[i],t[a]=t[e],t[e]^=t[r],t[r]=~t[r],t[a]|=t[n],t[a]^=t[i],t[i]&=t[n],t[n]^=t[r],t[r]&=t[a],t[a]^=t[n],t[n]|=t[i],t[i]^=t[e],t[r]^=t[e],t[e]|=t[a],t[r]^=t[a],t[n]^=t[e],t[a]^=t[n]},function(t,e,n,r,i,a){t[r]^=t[n],t[a]=t[i],t[i]=~t[i],t[i]|=t[r],t[r]^=t[a],t[a]^=t[e],t[i]^=t[n],t[n]|=t[r],t[r]^=t[e],t[n]^=t[a],t[a]|=t[i],t[r]^=t[i],t[a]^=t[r],t[r]&=t[n],t[r]^=t[i],t[i]^=t[a],t[a]^=t[e]},function(t,e,n,r,i,a){t[r]^=t[n],t[a]=t[n],t[n]&=t[r],t[n]^=t[e],t[e]|=t[a],t[a]^=t[i],t[e]^=t[i],t[i]|=t[n],t[n]^=t[r],t[n]^=t[i],t[e]^=t[r],t[r]^=t[i],t[i]&=t[n],t[n]^=t[e],t[e]&=t[r],t[a]^=t[i],t[i]^=t[e],t[e]^=t[n]},function(t,e,n,r,i,a){t[r]^=t[i],t[a]=t[e],t[e]&=t[n],t[e]^=t[r],t[r]|=t[i],t[a]=~t[a],t[n]^=t[e],t[e]^=t[r],t[r]&=t[a],t[r]^=t[e],t[e]|=t[a],t[e]^=t[i],t[i]&=t[r],t[a]^=t[i],t[i]^=t[n],t[n]&=t[e],t[a]^=t[n],t[e]^=t[i]},function(t,e,n,r,i,a){t[a]=t[n],t[n]|=t[r],t[r]^=t[a],t[n]^=t[i],t[i]&=t[a],t[r]^=t[i],t[i]|=t[e],t[e]=~t[e],t[i]^=t[r],t[r]|=t[e],t[a]^=t[n],t[r]^=t[a],t[a]&=t[e],t[e]^=t[n],t[n]^=t[i],t[e]&=t[r],t[r]^=t[i],t[e]^=t[r],t[r]^=t[a],t[a]^=t[i]},function(t,e,n,r,i,a){t[e]^=t[r],t[a]=t[e],t[e]&=t[i],t[r]^=t[i],t[e]^=t[r],t[i]^=t[n],t[r]|=t[a],t[r]^=t[i],t[i]&=t[e],t[e]=~t[e],t[i]^=t[n],t[n]&=t[r],t[a]^=t[e],t[i]^=t[a],t[a]^=t[r],t[e]^=t[n],t[r]^=t[e]},function(t,e,n,r,i,a){t[a]=t[i],t[i]&=t[e],t[e]^=t[r],t[r]|=t[a],t[a]^=t[n],t[e]=~t[e],t[n]|=t[i],t[a]^=t[e],t[e]&=t[r],t[e]^=t[n],t[n]&=t[r],t[i]^=t[r],t[a]^=t[i],t[r]&=t[i],t[i]|=t[e],t[n]^=t[a],t[i]^=t[a],t[a]&=t[e],t[a]^=t[r]}],l=[7788,63716,84032,7891,78949,25146,28835,67288,84032,40055,7361,1940,77639,27525,24193,75702,7361,35413,83150,82383,58619,48468,18242,66861,83150,69667,7788,31552,40054,23222,52496,57565,7788,63716],d=[44255,61867,45034,52496,73087,56255,43827,41448,18242,1939,18581,56255,64584,31097,26469,77728,77639,4216,64585,31097,66861,78949,58006,59943,49676,78950,5512,78949,27525,52496,18670,76143],g=[44255,60896,28835,1837,1057,4216,18242,77301,47399,53992,1939,1940,66420,39172,78950,45917,82383,7450,67288,26469,83149,57565,66419,47400,58006,44254,18581,18228,33048,45034,66508,7449];return{blocksize:16,open:function(e){var r,i,a,f;function c(t,e,r,i,a){o[a]=d[e]=n(o[t]^d[e]^d[r]^d[i]^2654435769^a,11)}function s(t,e,n,r,i){d[t]=o[i],d[e]=o[i+1],d[n]=o[i+2],d[r]=o[i+3]}function h(t,e,n,r,i){o[i]=d[t],o[i+1]=d[e],o[i+2]=d[n],o[i+3]=d[r]}for((t=e).reverse(),t[t.length]=1;t.length<32;)t[t.length]=0;for(r=0;r<8;r++)o[r]=255&t[4*r+0]|(255&t[4*r+1])<<8|(255&t[4*r+2])<<16|(255&t[4*r+3])<<24;var d=[o[3],o[4],o[5],o[6],o[7]];for(r=0,i=0;c(i++,0,4,2,r++),c(i++,1,0,3,r++),r<132;)c(i++,2,1,4,r++),8==r&&(i=0),c(i++,3,2,0,r++),c(i++,4,3,1,r++);for(r=128,i=3,f=0;a=l[f++],u[i++%8](d,a%5,a%7,a%11,a%13,a%17),h((a=l[f])%5,a%7,a%11,a%13,r),r>0;)s(a%5,a%7,a%11,a%13,r-=4)},close:function(){o=[]},encrypt:function(t,n){i=n;var o=(e=t).slice(i,i+16);o.reverse();var s=[r(o,0),r(o,4),r(o,8),r(o,12)];f(s,0,1,2,3,0);for(var h=0,l=d[h];u[h%8](s,l%5,l%7,l%11,l%13,l%17),h<31;)c(s,(l=d[++h])%5,l%7,l%11,l%13,l%17,h);f(s,0,1,2,3,32);for(var g=3;g>=0;g--,i+=4)a(e,i,s[g])},decrypt:function(t,n){i=n;var o=(e=t).slice(i,i+16);o.reverse();var c=[r(o,0),r(o,4),r(o,8),r(o,12)];f(c,0,1,2,3,32);for(var u=0,l=g[u];h[7-u%8](c,l%5,l%7,l%11,l%13,l%17),u<31;)s(c,(l=g[++u])%5,l%7,l%11,l%13,l%17,32-u);f(c,2,3,1,4,0),a(e,i,c[4]),a(e,i+4,c[1]),a(e,i+8,c[3]),a(e,i+12,c[2]),i+=16}}},TWOFISH:function(){var t=null,e=null,a=-1,f=[],c=[[],[],[],[]];function s(t){return c[0][o(t,0)]^c[1][o(t,1)]^c[2][o(t,2)]^c[3][o(t,3)]}function u(t){return c[0][o(t,3)]^c[1][o(t,0)]^c[2][o(t,1)]^c[3][o(t,2)]}function h(t,e){var r=s(e[0]),i=u(e[1]);e[2]=n(e[2]^r+i+f[4*t+8]&4294967295,31),e[3]=n(e[3],1)^r+2*i+f[4*t+9]&4294967295,r=s(e[2]),i=u(e[3]),e[0]=n(e[0]^r+i+f[4*t+10]&4294967295,31),e[1]=n(e[1],1)^r+2*i+f[4*t+11]&4294967295}function l(t,e){var r=s(e[0]),i=u(e[1]);e[2]=n(e[2],1)^r+i+f[4*t+10]&4294967295,e[3]=n(e[3]^r+2*i+f[4*t+11]&4294967295,31),r=s(e[2]),i=u(e[3]),e[0]=n(e[0],1)^r+i+f[4*t+8]&4294967295,e[1]=n(e[1]^r+2*i+f[4*t+9]&4294967295,31)}return{blocksize:16,open:function(e){var i,a,s,u,h,l,d,g,v,y=[],p=[],m=[],w=[],A=[[8,1,7,13,6,15,3,2,0,11,5,9,14,12,10,4],[2,8,11,13,15,7,6,14,3,1,9,4,0,10,12,5]],C=[[14,12,11,8,1,2,3,5,15,4,10,6,7,0,9,13],[1,14,2,11,4,12,3,7,6,13,10,5,15,9,0,8]],B=[[11,10,5,14,6,13,9,0,12,8,15,3,2,4,7,1],[4,12,7,5,1,6,9,10,0,14,13,8,2,11,3,15]],_=[[13,7,15,4,1,2,6,14,9,11,3,0,8,5,12,10],[11,9,5,1,12,3,13,14,6,4,7,15,2,0,8,10]],O=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15],x=[0,9,2,11,4,13,6,15,8,1,10,3,12,5,14,7],b=[[],[]],k=[[],[],[],[]];function S(t){return t^t>>2^[0,90,180,238][3&t]}function L(t){return t^t>>1^t>>2^[0,238,180,90][3&t]}function E(t,e){var n,r,i;for(n=0;n<8;n++)r=e>>>24,e=e<<8&4294967295|t>>>24,t=t<<8&4294967295,i=r<<1,128&r&&(i^=333),e^=r^i<<16,i^=r>>>1,1&r&&(i^=166),e^=i<<24|i<<8;return e}function z(t,e){var n,r,i,a;return n=e>>4,r=15&e,i=A[t][n^r],a=C[t][O[r]^x[n]],_[t][O[a]^x[i]]<<4|B[t][i^a]}function R(t,e){var n=o(t,0),r=o(t,1),i=o(t,2),a=o(t,3);switch(l){case 4:n=b[1][n]^o(e[3],0),r=b[0][r]^o(e[3],1),i=b[0][i]^o(e[3],2),a=b[1][a]^o(e[3],3);case 3:n=b[1][n]^o(e[2],0),r=b[1][r]^o(e[2],1),i=b[0][i]^o(e[2],2),a=b[0][a]^o(e[2],3);case 2:n=b[0][b[0][n]^o(e[1],0)]^o(e[0],0),r=b[0][b[1][r]^o(e[1],1)]^o(e[0],1),i=b[1][b[0][i]^o(e[1],2)]^o(e[0],2),a=b[1][b[1][a]^o(e[1],3)]^o(e[0],3)}return k[0][n]^k[1][r]^k[2][i]^k[3][a]}for(i=(t=(t=e).slice(0,32)).length;16!=i&&24!=i&&32!=i;)t[i++]=0;for(i=0;i<t.length;i+=4)m[i>>2]=r(t,i);for(i=0;i<256;i++)b[0][i]=z(0,i),b[1][i]=z(1,i);for(i=0;i<256;i++)g=S(d=b[1][i]),v=L(d),k[0][i]=d+(g<<8)+(v<<16)+(v<<24),k[2][i]=g+(v<<8)+(d<<16)+(v<<24),g=S(d=b[0][i]),v=L(d),k[1][i]=v+(v<<8)+(g<<16)+(d<<24),k[3][i]=g+(d<<8)+(v<<16)+(g<<24);for(l=m.length/2,i=0;i<l;i++)a=m[i+i],y[i]=a,s=m[i+i+1],p[i]=s,w[l-i-1]=E(a,s);for(i=0;i<40;i+=2)s=16843009+(a=16843009*i),a=R(a,y),s=n(R(s,p),8),f[i]=a+s&4294967295,f[i+1]=n(a+2*s,9);for(i=0;i<256;i++)switch(a=s=u=h=i,l){case 4:a=b[1][a]^o(w[3],0),s=b[0][s]^o(w[3],1),u=b[0][u]^o(w[3],2),h=b[1][h]^o(w[3],3);case 3:a=b[1][a]^o(w[2],0),s=b[1][s]^o(w[2],1),u=b[0][u]^o(w[2],2),h=b[0][h]^o(w[2],3);case 2:c[0][i]=k[0][b[0][b[0][a]^o(w[1],0)]^o(w[0],0)],c[1][i]=k[1][b[0][b[1][s]^o(w[1],1)]^o(w[0],1)],c[2][i]=k[2][b[1][b[0][u]^o(w[1],2)]^o(w[0],2)],c[3][i]=k[3][b[1][b[1][h]^o(w[1],3)]^o(w[0],3)]}},close:function(){f=[],c=[[],[],[],[]]},encrypt:function(t,n){for(var o=[r(e=t,a=n)^f[0],r(e,a+4)^f[1],r(e,a+8)^f[2],r(e,a+12)^f[3]],c=0;c<8;c++)h(c,o);i(e,a,o[2]^f[4]),i(e,a+4,o[3]^f[5]),i(e,a+8,o[0]^f[6]),i(e,a+12,o[1]^f[7]),a+=16},decrypt:function(t,n){for(var o=[r(e=t,a=n)^f[4],r(e,a+4)^f[5],r(e,a+8)^f[6],r(e,a+12)^f[7]],c=7;c>=0;c--)l(c,o);i(e,a,o[2]^f[0]),i(e,a+4,o[3]^f[1]),i(e,a+8,o[0]^f[2]),i(e,a+12,o[1]^f[3]),a+=16}}}};function s(t,e,n,r){this.algorithm=t,this.direction=e,this.mode=n,this.padding=r,this.modeOpen=n[e].open,this.modeExec=n[e].exec,this.modeClose=n[e].close,this.keyBytes=null,this.dataBytes=null,this.dataOffset=-1,this.dataLength=-1}return s.prototype={open:function(t,e){if(null==t)throw"keyBytes is null";if(null==e)throw"dataBytes is null";this.keyBytes=t.concat(),this.dataBytes=e,this.dataOffset=0,this.dataLength=e.length,"encrypt"==this.direction&&this.padding.append(this.dataBytes),this.modeOpen()},close:function(){return this.modeClose(),"decrypt"==this.direction&&this.padding.remove(this.dataBytes),this.dataBytes},operate:function(){return this.modeExec()},execute:function(t,e){for(this.open(t,e);;){if(!(0<this.operate()))break}return this.close()}},s.create=function(t,e){try{return new s(c[t](),e,{encrypt:{open:function(){this.algorithm.open(this.keyBytes),this.dataBytes.unshift(f(),f(),f(),f(),f(),f(),f(),f(),f(),f(),f(),f(),f(),f(),f(),f()),this.dataLength=this.dataBytes.length,this.dataOffset=16},exec:function(){for(var t=this.dataOffset;t<this.dataOffset+16;t++)this.dataBytes[t]^=this.dataBytes[t-16];return this.algorithm.encrypt(this.dataBytes,this.dataOffset),this.dataOffset+=this.algorithm.blocksize,this.dataLength<=this.dataOffset?0:this.dataLength-this.dataOffset},close:function(){this.algorithm.close()}},decrypt:{open:function(){this.algorithm.open(this.keyBytes),this.dataLength=this.dataBytes.length,this.dataOffset=16,this.iv=this.dataBytes.slice(0,16)},exec:function(){var t=this.dataBytes.slice(this.dataOffset,this.dataOffset+16);this.algorithm.decrypt(this.dataBytes,this.dataOffset);for(var e=0;e<16;e++)this.dataBytes[this.dataOffset+e]^=this.iv[e];return this.dataOffset+=this.algorithm.blocksize,this.iv=t,this.dataLength<=this.dataOffset?0:this.dataLength-this.dataOffset},close:function(){for(this.algorithm.close(),this.dataBytes.splice(0,16);0==this.dataBytes[this.dataBytes.length-1];)this.dataBytes.pop()}}},{append:function(t){for(var e=16-t.length%16,n=0;n<e;n++)t.push(e);return t},remove:function(t){var e=t.pop();16<e&&(e=0);for(var n=1;n<e;n++)t.pop();return t}})}catch(t){if(t)return console.error(t)}},{generateKey:function(e){let n=new Array(32);for(var r=0;r<n.length;r++)n[r]=f();return"base64"===e?n=t.base64_encode(n):"hex"===e&&(n=t.hex_encode(n)),n},enc:function(e,n,r,i){n=t[i+"_decode"](n);let a=s.create(r,"encrypt").execute(n,t.str2utf8(e));return t[i+"_encode"](a)},dec:function(e,n,r,i){let a=s.create(r,"decrypt");return t.utf82str(a.execute(t[i+"_decode"](n),t[i+"_decode"](e)))},enc2x:function(t,e,n,r){let i=this.enc(t,e[0],n[0],r);return this.enc(i,e[1],n[1],r)},enc3x:function(t,e,n,r){let i=this.enc(t,e[0],n[0],r);return i=this.enc(i,e[1],n[1],r),this.enc(i,e[2],n[2],r)},dec2x:function(t,e,n,r){e=e.reverse(),n=n.reverse();let i=this.dec(t,e[0],n[0],r);return this.dec(i,e[1],n[1],r)},dec3x:function(t,e,n,r){e=e.reverse(),n=n.reverse();let i=this.dec(t,e[0],n[0],r);return i=this.dec(i,e[1],n[1],r),this.dec(i,e[2],n[2],r)}}}const xcrypt=new XCRYPT;
